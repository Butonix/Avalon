exports.ids=[46],exports.modules={239:function(t,e,r){"use strict";r.d(e,"l",function(){return o}),r.d(e,"s",function(){return n}),r.d(e,"g",function(){return l}),r.d(e,"j",function(){return c}),r.d(e,"c",function(){return d}),r.d(e,"k",function(){return m}),r.d(e,"d",function(){return _}),r.d(e,"q",function(){return f}),r.d(e,"h",function(){return v}),r.d(e,"o",function(){return $}),r.d(e,"f",function(){return h}),r.d(e,"r",function(){return x}),r.d(e,"a",function(){return w}),r.d(e,"p",function(){return y}),r.d(e,"m",function(){return k}),r.d(e,"e",function(){return j}),r.d(e,"b",function(){return A}),r.d(e,"i",function(){return C}),r.d(e,"n",function(){return E});const o=(t,{id:e})=>t.$axios.$get(`cartoon_role/${e}/stock_show`),n=(t,{id:e,amount:r})=>t.$axios.$post(`cartoon_role/${e}/buy_stock`,{amount:r}),l=(t,{bangumi_id:e,name:r,intro:o,avatar:n,alias:l})=>t.$axios.$post("cartoon_role/manager/create",{bangumi_id:e,name:r,intro:o,avatar:n,alias:l}),c=(t,form)=>t.$axios.$post("cartoon_role/manager/edit",form),d=(t,form)=>t.$axios.$post("cartoon_role/manager/user_create",form),m=(t,{id:e})=>t.$axios.$get(`cartoon_role/${e}/get_deal`),_=(t,form)=>t.$axios.$post("cartoon_role/create_deal",form),f=(t,form)=>t.$axios.$post("cartoon_role/make_deal",form),v=(t,{id:e})=>t.$axios.$post("cartoon_role/delete_deal",{id:e}),$=t=>t.$axios.$get("cartoon_role/stock_meta"),h=(t,form)=>t.$axios.$post("cartoon_role/create_market_price_draft",form),x=(t,{is_agree:e,idol_id:r,draft_id:o})=>t.$axios.$post("cartoon_role/vote_market_price_draft",{is_agree:e,idol_id:r,draft_id:o}),w=(t,{idol_id:e,qq_group:r,lover_words:o,manager_id:n})=>t.$axios.$post("cartoon_role/change_idol_profile",{idol_id:e,qq_group:r,lover_words:o,manager_id:n}),y=t=>t.$axios.$get("cartoon_role/user_draft_work"),k=t=>t.$axios.$get("cartoon_role/can_use_income"),j=(t,{product_id:e,product_type:r,amount:o})=>t.$axios.$post("cartoon_role/create_buy_request",{product_id:e,product_type:r,amount:o}),A=(t,{order_id:e,result:r})=>t.$axios.$post("cartoon_role/check_product_request",{order_id:e,result:r}),C=(t,{order_id:e})=>t.$axios.$post("cartoon_role/delete_buy_request",{order_id:e}),E=t=>t.$axios.$get("cartoon_role/get_mine_product_orders")},345:function(t,e){},443:function(t,e,r){"use strict";r.r(e);var o=r(345),n=r.n(o);for(var l in o)"default"!==l&&function(t){r.d(e,t,function(){return o[t]})}(l);e.default=n.a},504:function(t,e,r){"use strict";r.r(e);var o=r(6),n=r(239),l={name:"CreateRoleForm",mixins:[o.a],data:()=>({form:{name:"",alias:"",bangumi_id:"",avatar:"",intro:""},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"submit"}],avatar:[{required:!0,message:"头像不能为空",trigger:"change"}],alias:[{validator:(t,e,r)=>e&&e.length?e.length>5?r(new Error("最多填写 5 个别名")):e.join("").length>200?r(new Error("最多 200 字")):void r():r(new Error("至少填写 1 个别名")),trigger:"submit"}],intro:[{required:!0,min:20,max:400,message:"最少20字，最多400字",trigger:"submit"}],bangumi_id:[{required:!0,message:"番剧是必选",trigger:"blur"}]},submitting:!1}),computed:{user(){return this.$store.state.user},login(){return this.$store.state.login}},methods:{handleAvatarSuccess(t){this.$toast.success("上传成功"),this.form.avatar=t.data.url},submitForm(){if(!this.login)return this.$toast.info("继续操作前请先登录"),void this.$channel.$emit("sign-in");+this.user.pocket<10?this.$toast.info("你没有足够的虚拟币"):this.$refs.form.validate(async t=>{if(t){if(this.submitting)return;this.submitting=!0;const t=this.form.name;try{const e={bangumi_id:this.form.bangumi_id,name:t,intro:this.form.intro.trim(),avatar:this.form.avatar,alias:[t].concat(this.form.alias.filter(e=>e!==t)).toString()};"string"!=typeof e.alias&&(e.alias=e.alias.join(","));const r=await Object(n.c)(this,e);this.$toast.success("偶像创建成功"),setTimeout(()=>{window.location=this.$alias.cartoonRole(r)},1e3)}catch(t){this.$toast.error(t)}finally{this.submitting=!1}}})}}},c=r(0);var d={name:"RoleTrendingRegister",components:{CreateRoleForm:Object(c.a)(l,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"create-role-form"},[r("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"40px"}},[r("el-form-item",{attrs:{label:"名称",prop:"name"}},[r("el-col",{attrs:{span:16}},[r("el-input",{attrs:{placeholder:"中文名"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name","string"==typeof e?e.trim():e)},expression:"form.name"}})],1)],1),t._v(" "),r("el-form-item",{attrs:{label:"别名",prop:"alias"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"角色的其它名字，如：英文名、日文名"},model:{value:t.form.alias,callback:function(e){t.$set(t.form,"alias",e)},expression:"form.alias"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"番剧",prop:"bangumi_id"}},[r("bangumi-search",{model:{value:t.form.bangumi_id,callback:function(e){t.$set(t.form,"bangumi_id",e)},expression:"form.bangumi_id"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"头像",prop:"avatar",required:""}},[r("el-col",{attrs:{span:16}},[r("el-input",{attrs:{disabled:!0},model:{value:t.form.avatar,callback:function(e){t.$set(t.form,"avatar","string"==typeof e?e.trim():e)},expression:"form.avatar"}},[r("template",{slot:"prepend"},[t._v("https://image.calibur.tv/")])],2)],1),t._v(" "),r("el-col",{attrs:{span:2,offset:1}},[r("el-form-item",[r("el-upload",{attrs:{data:t.uploadHeaders,"show-file-list":!1,"on-success":t.handleAvatarSuccess,"on-error":t.handleImageUploadError,"before-upload":t.beforeImageUpload,action:t.imageUploadAction,accept:t.imageUploadAccept}},[r("el-button",{attrs:{type:"text"}},[r("i",{staticClass:"el-icon-plus"}),t._v("\n              上传\n            ")])],1)],1)],1),t._v(" "),t.form.avatar?r("el-col",{attrs:{span:2}},[r("el-popover",{ref:"popoverAvatar",attrs:{placement:"left",width:"100",trigger:"hover"}},[r("img",{attrs:{src:t.$resize(t.form.avatar,{width:250})}})]),t._v(" "),r("a",{directives:[{name:"popover",rawName:"v-popover:popoverAvatar",arg:"popoverAvatar"}],attrs:{href:t.imagePrefix+t.form.avatar,type:"text",target:"_blank"}},[r("i",{staticClass:"el-icon-view"}),t._v(" 预览\n        ")])],1):t._e()],1),t._v(" "),r("el-form-item",{attrs:{label:"简介",prop:"intro"}},[r("el-input",{attrs:{rows:10,type:"textarea",placeholder:"请输入角色简介，最多400字"},model:{value:t.form.intro,callback:function(e){t.$set(t.form,"intro",e)},expression:"form.intro"}})],1),t._v(" "),r("el-form-item",[r("el-col",{attrs:{span:3,offset:21}},[r("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("立即创建")])],1)],1)],1)],1)},[],!1,function(t){},null,"3c6a9e5f").exports},head:{title:"注册公司"}};var m=Object(c.a)(d,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"role-trending-register"},[r("v-layout",[r("div",{staticClass:"create-role-tips"},[r("el-alert",{attrs:{type:"info"}},[r("ul",[r("li",[t._v("创办公司，需要交纳10个虚拟币（团子或光玉）作为注册资本")]),t._v(" "),r("li",[t._v("请勿创建与番剧无关的角色，违者删除角色并禁言一周")]),t._v(" "),r("li",[t._v("请勿发布错误的资料。头像、别名、简介等要保持一致")]),t._v(" "),r("li",[t._v("请勿创建重复的偶像，创建前善用搜索，重复的偶像将被删除")]),t._v(" "),r("li",[t._v("偶像创建成功后，只要有20个人参股，就可以自动上市")]),t._v(" "),r("li",[t._v("\n            其它详情，请查看\n            "),r("nuxt-link",{attrs:{to:"/role/trending/intro"}},[r("el-button",{attrs:{round:"",size:"mini"}},[t._v("股市介绍")])],1),t._v("\n            页面\n          ")],1)])])],1),t._v(" "),r("create-role-form"),t._v(" "),r("template",{slot:"aside"},[t._v(" ")])],2)],1)},[],!1,function(t){var e=r(443);e.__inject__&&e.__inject__(t)},null,"05a01d2c");e.default=m.exports}};
//# sourceMappingURL=register.chunk.c175aec2.js.map