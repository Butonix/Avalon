exports.ids=[11],exports.modules={255:function(t,e){},256:function(t,e){},257:function(t,e){},286:function(t,e,n){"use strict";n.r(e);var r=n(255),o=n.n(r);for(var l in r)"default"!==l&&function(t){n.d(e,t,function(){return r[t]})}(l);e.default=o.a},287:function(t,e,n){"use strict";n.r(e);var r=n(256),o=n.n(r);for(var l in r)"default"!==l&&function(t){n.d(e,t,function(){return r[t]})}(l);e.default=o.a},288:function(t,e,n){"use strict";n.r(e);var r=n(257),o=n.n(r);for(var l in r)"default"!==l&&function(t){n.d(e,t,function(){return r[t]})}(l);e.default=o.a},302:function(t,e,n){"use strict";var r={name:"Waterfall",props:{lineCount:{required:!0,type:Number,validator:t=>t>=2},lineWidth:{required:!0,type:[Number,String]},marginRight:{type:Number,default:0,validator:t=>t>=0},marginBottom:{type:Number,default:0,validator:t=>t>=0},extraHeight:{type:Number,default:0,validator:t=>t>=0},maxHeight:{type:Number,default:0,validator:t=>t>=0},vwViewport:{type:Number,default:0,validator:t=>t>=0},lazyScale:{type:Number,default:1.3,validator:t=>t>=1}},data(){return{height:0,lineHeight:new Array(this.lineCount).fill(0),lastScrollTop:0,rectTop:"",windowHeight:this.$isServer?0:window.innerHeight,windowWidth:this.$isServer?0:window.innerWidth}},computed:{containerStyle(){return{height:`${this.height}px`}},imageWidth(){if(this.$isServer)return 0;const t={}.toString,e=this.lineWidth;if((e=>"[object Number]"===t.call(e))(e))return e;const n=(this.lineCount-1)*this.marginRight;return/vw$/.test(e)?+parseFloat((this.windowWidth-n)*e.replace("vw","")/100).toFixed(2):/%$/.test(e)?+parseFloat((this.$el.parentNode.offsetWidth-n)*e.replace("%","")/100).toFixed(2):+e.replace("px","")}},created(){this.$isServer||(this.$on("render",this.renderHandler),((t,e,n,r=!1)=>{t.addEventListener(e,n,r)})(window,"scroll",this.onScreenScroll))},beforeDestroy(){((t,e,n,r=!1)=>{t.removeEventListener(e,n,r)})(window,"scroll",this.onScreenScroll)},methods:{onScreenScroll:((t,e,n)=>{let r,o,l,c=null,d=0;n||(n={});const h=function(){d=!1===n.leading?0:Date.now(),c=null,l=t.apply(r,o),c||(r=o=null)};return function(){const m=Date.now();d||!1!==n.leading||(d=m);const f=e-(m-d);return r=this,o=arguments,f<=0||f>e?(c&&(clearTimeout(c),c=null),d=m,l=t.apply(r,o),c||(r=o=null)):c||!1===n.trailing||(c=setTimeout(h,f)),l}})(function(){this.lastScrollTop=document.documentElement.scrollTop||document.body.scrollTop,this.showOrHiddenItem()},200),renderHandler(t){const e=this.computeItemColIndex(),n=this.computedItemHeight(t),r=t.index>=this.lineCount,o=this.lineHeight[e];t.style={left:`${e*(this.imageWidth+this.marginRight)}px`,top:`${o}px`,width:`${this.imageWidth}px`,height:`${n}px`,marginTop:r?`${this.marginBottom}px`:""};const l=this.getContainerRectTop();t.top=l+o,t.bottom=l+o+n,this.checkInView(t),this.lineHeight[e]=+parseFloat(o+(r?n+this.marginBottom:n)).toFixed(2),this.computeContainerHeight()},computeItemColIndex(){const{lineHeight:t}=this;return t.indexOf(Math.min(...t))},computedItemHeight(t){const e=+parseFloat(t.height/t.width*this.imageWidth).toFixed(2)+(this.vwViewport?this.extraHeight*this.windowWidth/this.vwViewport:this.extraHeight);return this.maxHeight&&e>this.maxHeight?this.maxHeight:e},computeContainerHeight(){this.height=Math.max(...this.lineHeight)},showOrHiddenItem(){this.$children.forEach(this.checkInView)},checkInView(t){const{lastScrollTop:e,windowHeight:n,lazyScale:r}=this;t.display=t.top<(e+n)*r&&t.bottom>e/r},getContainerRectTop(){if(""!==this.rectTop)return this.rectTop;const t=(t=>{let e=0;do{isNaN(t.offsetTop)||(e+=t.offsetTop)}while(t=t.offsetParent);return e})(this.$el);return this.rectTop=t,t}}},o=n(0);var l=Object(o.a)(r,function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"vue-waterfall-container",style:this.containerStyle},[this._t("default")],2)},[],!1,function(t){var e=n(286);e.__inject__&&e.__inject__(t)},null,"72a93c13").exports,c={name:"WaterfallSlot",props:{width:{type:[Number,String],required:!0},height:{type:[Number,String],required:!0},index:{type:[Number,String],required:!0},transition:{type:String,default:""}},data:()=>({top:0,bottom:0,display:!1,style:{}}),mounted(){this.notify()},methods:{notify(){this.$parent.$emit("render",this)}}};var d={name:"ImageWaterfallFlow",components:{Waterfall:l,WaterfallSlot:Object(o.a)(c,function(){var t=this.$createElement,e=this._self._c||t;return e("keep-alive",[e("transition",{attrs:{name:this.transition}},[this.display?e("div",{staticClass:"waterfall-slot",style:this.style},[this._t("default")],2):this._e()])],1)},[],!1,function(t){var e=n(287);e.__inject__&&e.__inject__(t)},null,"2df125b1").exports},props:{list:{required:!0,type:Array,default:()=>[]},bangumiId:{type:[Number,String],default:0},userZone:{type:String,default:""}},methods:{getRandomColor(){const t=["rgba(21,174,103,.5)","rgba(245,163,59,.5)","rgba(255,230,135,.5)","rgba(194,217,78,.5)","rgba(195,123,177,.5)","rgba(125,205,244,.5)"];return t[~~(Math.random()*t.length)]}}};var h=Object(o.a)(d,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"image-waterfall-flow"}},[n("waterfall",{attrs:{"line-count":4,"margin-right":12,"margin-bottom":12,"extra-height":106,"max-height":436,"lazy-scale":2,"line-width":"25%"}},t._l(t.list,function(e,r){return n("waterfall-slot",{key:e.id,attrs:{index:r,width:e.source.width,height:e.source.height}},[n("div",{staticClass:"image-item"},[n("a",{staticClass:"image-box",class:{"album-box":e.is_album},attrs:{href:t.$alias.image(e.id),target:"_blank"}},[e.is_creator?n("el-tooltip",{attrs:{effect:"dark",content:"原创",placement:"top"}},[n("i",{staticClass:"is-creator iconfont icon-huangguan"})]):t._e(),t._v(" "),n("div",{staticClass:"image",style:{backgroundColor:""+t.getRandomColor(),backgroundImage:"url("+t.$resize(e.source.url,{width:400,mode:2})+")",paddingTop:e.source.height/e.source.width*100+"%"}}),t._v(" "),e.is_album?n("div",{staticClass:"is-album"},[n("i",{staticClass:"el-icon-picture-outline"}),t._v(" "),n("span",{staticClass:"image-count",domProps:{textContent:t._s(e.image_count)}})]):t._e()],1),t._v(" "),n("div",{staticClass:"panel"},[n("div",{staticClass:"intro"},[n("p",{staticClass:"name oneline",domProps:{textContent:t._s(e.name)}}),t._v(" "),n("div",{staticClass:"social"},[e.is_creator?n("span",[n("i",{staticClass:"iconfont icon-fantuan"}),t._v("\n                "+t._s(e.reward_count)+"\n              ")]):n("span",[n("i",{staticClass:"iconfont icon-like"}),t._v("\n                "+t._s(e.like_count)+"\n              ")]),t._v(" "),n("span",[n("i",{staticClass:"iconfont icon-talk"}),t._v("\n                "+t._s(e.comment_count)+"\n              ")]),t._v(" "),n("span",[n("i",{staticClass:"iconfont icon-mark"}),t._v("\n                "+t._s(e.mark_count)+"\n              ")])])]),t._v(" "),n("div",{staticClass:"about"},[t.userZone?[n("a",{staticClass:"bangumi-avatar",attrs:{href:t.$alias.bangumi(e.bangumi.id),target:"_blank"}},[n("v-img",{attrs:{src:e.bangumi.avatar,width:30,height:30,lazy:!1}})],1),t._v(" "),n("div",{staticClass:"info"},[n("a",{staticClass:"main-name oneline",attrs:{href:t.$alias.bangumi(e.bangumi.id),target:"_blank"},domProps:{textContent:t._s(e.bangumi.name)}})])]:t.bangumiId?n("user-card",{attrs:{id:e.user.id,zone:e.user.zone}},[n("v-img",{staticClass:"user-avatar",attrs:{src:e.user.avatar,width:30,height:30,lazy:!1}}),t._v(" "),n("span",{staticClass:"main-name",domProps:{textContent:t._s(e.user.nickname)}})],1):[n("a",{staticClass:"bangumi-avatar",attrs:{href:t.$alias.bangumi(e.bangumi.id),target:"_blank"}},[n("v-img",{attrs:{src:e.bangumi.avatar,width:30,height:30,lazy:!1}})],1),t._v(" "),n("div",{staticClass:"info"},[n("p",{staticClass:"main-info"},[n("span",[t._v("UP：")]),t._v(" "),n("user-card",{staticStyle:{float:"none"},attrs:{id:e.user.id,zone:e.user.zone,"custom-class":"oneline"}},[t._v("\n                    "+t._s(e.user.nickname)+"\n                  ")])],1),t._v(" "),n("a",{staticClass:"oneline",attrs:{href:t.$alias.bangumi(e.bangumi.id),target:"_blank"},domProps:{textContent:t._s(e.bangumi.name)}})])]],2)])])])}),1)],1)},[],!1,function(t){var e=n(288);e.__inject__&&e.__inject__(t)},null,"326bf112");e.a=h.exports},553:function(t,e,n){"use strict";n.r(e);var r={name:"BangumiImageFlow",components:{ImageWaterfallFlow:n(302).a},props:{id:{required:!0,type:String}},computed:{bangumi(){return this.$store.state.bangumi.show}},async asyncData({store:t,params:e}){await t.dispatch("flow/initData",{id:e.id,func:"getBangumiImage",type:"seenIds",sort:"active"})},methods:{handleImageClick(){if(!this.$store.state.login)return this.$toast.info("继续操作前请先登录"),void this.$channel.$emit("sign-in");this.$channel.$emit("show-upload-image-modal",{bangumiId:this.id})}}},o=n(0),component=Object(o.a)(r,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"bangumi-image-flow"}},[n("flow-list",{attrs:{id:t.id,func:"getBangumiImage",type:"seenIds",sort:"active"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.flow;return n("image-waterfall-flow",{attrs:{"bangumi-id":t.id,list:r}})}}])},[t._v(" "),n("no-content",{attrs:{slot:"nothing"},slot:"nothing"},[n("el-button",{attrs:{round:!0,type:"primary"},on:{click:t.handleImageClick}},[t._v("\n        上传《"+t._s(t.bangumi.name)+"》的第一张美图\n      ")])],1)],1)],1)},[],!1,null,null,"6a8874df");e.default=component.exports}};
//# sourceMappingURL=pins.chunk.7570ea1e.js.map